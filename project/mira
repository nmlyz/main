import requests,json,time,sys,base64

def start(id):
    req = requests.get("https://www.mirrativ.com/api/user/profile",params= {"user_id":str(id)})
    livehost = req.json()["name"]
    try:
        live_id=req.json()["onlive"]["live_id"]
    except TypeError:
        print("配信データがありません")
        sys.exit()
    print(f'hostName = [{livehost}]\nliveId   = [{live_id}]')
    return live_id



def app(live_id, count):
    url = f"https://www.mirrativ.com/api/live/online_users?live_id={live_id}&page=1"
    headers = {
        'User-Agent': 'MR_APP/10.45.3/Android/PIXEL 8/12',
    }
    response = requests.get(url, headers=headers)

    if response.status_code == 200:
        data = response.json()
        users = data.get('users', [])
        user_info = [{'name': user.get('name', '').encode().decode('utf-8', 'ignore'), 'user_id': user.get('user_id', '')} for user in users]
        
        # 現在時刻取得
        current_time = time.localtime()
        hour = current_time.tm_hour
        minute = current_time.tm_min
        second = current_time.tm_sec

        print(f"\n[!]{hour:2d}時{minute:2d}分{second:2d}秒: {len(user_info):2d}人オンラインです。[!]")
        for user in user_info:
            count += 1
            print(f"{count:<2}| id:{user['user_id']:<10} name:{user['name']}")
        return count
    else:
        print(f"Error: {response.status_code}")
        print(response.text)

def main(rangeNum,timeNum,userId):
    for i in range(int(rangeNum)):
        count = 0
        count = app(start(userId), count)
        time.sleep(int(timeNum))
    print("終了。")